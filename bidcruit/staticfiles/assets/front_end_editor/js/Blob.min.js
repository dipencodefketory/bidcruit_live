/* Blob.js
 * A Blob, File, FileReader & URL implementation.
 * 2019-04-19
 *
 * By Eli Grey, http://eligrey.com
 * By Jimmy Wärting, https://github.com/jimmywarting
 * License: MIT
 *   See https://github.com/eligrey/Blob.js/blob/master/LICENSE.md
 */
!function(){var f="object"==typeof window?window:"object"==typeof self?self:this,n=f.BlobBuilder||f.WebKitBlobBuilder||f.MSBlobBuilder||f.MozBlobBuilder;f.URL=f.URL||f.webkitURL||function(e,t){return(t=document.createElement("a")).href=e,t};var r=f.Blob,p=URL.createObjectURL,y=URL.revokeObjectURL,o=f.Symbol&&f.Symbol.toStringTag,e=!1,t=!1,d=!!f.ArrayBuffer,i=n&&n.prototype.append&&n.prototype.getBlob;try{e=2===new Blob(["ä"]).size,t=2===new Blob([new Uint8Array([1,2])]).size}catch(e){}function a(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t,r=e.buffer;return e.byteLength!==r.byteLength&&((t=new Uint8Array(e.byteLength)).set(new Uint8Array(r,e.byteOffset,e.byteLength)),r=t.buffer),r}return e})}function s(e,t){t=t||{};var r=new n;return a(e).forEach(function(e){r.append(e)}),t.type?r.getBlob(t.type):r.getBlob()}function u(e,t){return new r(a(e),t||{})}f.Blob&&(s.prototype=Blob.prototype,u.prototype=Blob.prototype);var b="function"==typeof TextEncoder?TextEncoder.prototype.encode.bind(new TextEncoder):function(e){for(var t=0,r=e.length,n=f.Uint8Array||Array,o=0,i=Math.max(32,r+(r>>1)+7),a=new n(i>>3<<3);t<r;){var s,l=e.charCodeAt(t++);if(55296<=l&&l<=56319)if(t<r&&(56320==(64512&(s=e.charCodeAt(t)))&&(++t,l=((1023&l)<<10)+(1023&s)+65536)),55296<=l&&l<=56319)continue;if(o+4>a.length&&(i+=8,i=(i*=1+t/e.length*2)>>3<<3,(s=new Uint8Array(i)).set(a),a=s),0!=(4294967168&l)){if(0==(4294965248&l))a[o++]=l>>6&31|192;else if(0==(4294901760&l))a[o++]=l>>12&15|224,a[o++]=l>>6&63|128;else{if(0!=(4292870144&l))continue;a[o++]=l>>18&7|240,a[o++]=l>>12&63|128,a[o++]=l>>6&63|128}a[o++]=63&l|128}else a[o++]=l}return a.slice(0,o)},h="function"==typeof TextDecoder?TextDecoder.prototype.decode.bind(new TextDecoder):function(e){for(var t=e.length,r=[],n=0;n<t;){var o,i,a,s,l=e[n],u=null,c=239<l?4:223<l?3:191<l?2:1;if(n+c<=t)switch(c){case 1:l<128&&(u=l);break;case 2:128==(192&(o=e[n+1]))&&127<(s=(31&l)<<6|63&o)&&(u=s);break;case 3:o=e[n+1],i=e[n+2],128==(192&o)&&128==(192&i)&&2047<(s=(15&l)<<12|(63&o)<<6|63&i)&&(s<55296||57343<s)&&(u=s);break;case 4:o=e[n+1],i=e[n+2],a=e[n+3],128==(192&o)&&128==(192&i)&&128==(192&a)&&65535<(s=(15&l)<<18|(63&o)<<12|(63&i)<<6|63&a)&&s<1114112&&(u=s)}null===u?(u=65533,c=1):65535<u&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),n+=c}for(var f=r.length,p="",n=0;n<f;)p+=String.fromCharCode.apply(String,r.slice(n,n+=4096));return p};function c(){var e=!!f.ActiveXObject||"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,t=f.XMLHttpRequest&&f.XMLHttpRequest.prototype.send;e&&t&&(XMLHttpRequest.prototype.send=function(e){e instanceof Blob&&this.setRequestHeader("Content-Type",e.type),t.call(this,e)});try{new File([],"")}catch(e){try{var r=new Function('class File extends Blob {constructor(chunks, name, opts) {opts = opts || {};super(chunks, opts || {});this.name = name.replace(///g, ":");this.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();this.lastModified = +this.lastModifiedDate;}};return new File([], ""), File')();f.File=r}catch(e){r=function(e,t,r){e=new Blob(e,r),r=r&&void 0!==r.lastModified?new Date(r.lastModified):new Date;return e.name=t.replace(/\//g,":"),e.lastModifiedDate=r,e.lastModified=+r,e.toString=function(){return"[object File]"},o&&(e[o]="File"),e};f.File=r}}}e?(c(),f.Blob=t?f.Blob:u):i?(c(),f.Blob=s):function(){function a(e){for(var t=new Array(e.byteLength),r=new Uint8Array(e),n=t.length;n--;)t[n]=r[n];return t}function t(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=[],n=0;n<e.length;n+=3){var o=e[n],i=n+1<e.length,a=i?e[n+1]:0,s=n+2<e.length,l=s?e[n+2]:0,u=o>>2,o=(3&o)<<4|a>>4,a=(15&a)<<2|l>>6,l=63&l;s||(l=64,i||(a=64)),r.push(t[u],t[o],t[a],t[l])}return r.join("")}var r,s,e=Object.create||function(e){function t(){}return t.prototype=e,new t};function u(e,t){t=null==t?{}:t;for(var r,n=0,o=(e=e||[]).length;n<o;n++){var i=e[n];i instanceof u?e[n]=i._buffer:"string"==typeof i?e[n]=b(i):d&&(ArrayBuffer.prototype.isPrototypeOf(i)||s(i))?e[n]=a(i):d&&((r=i)&&DataView.prototype.isPrototypeOf(r))?e[n]=a(i.buffer):e[n]=b(String(i))}this._buffer=f.Uint8Array?function(e){for(var t=0,r=e.length;r--;)t+=e[r].length;var n=new Uint8Array(t),o=0,r=0;for(l=e.length;r<l;r++){var i=e[r];n.set(i,o),o+=i.byteLength||i.length}return n}(e):[].concat.apply([],e),this.size=this._buffer.length,this.type=t.type||"",/[^\u0020-\u007E]/.test(this.type)?this.type="":this.type=this.type.toLowerCase()}function n(e,t,r){e=u.call(this,e,r=r||{})||this;return e.name=t.replace(/\//g,":"),e.lastModifiedDate=r.lastModified?new Date(r.lastModified):new Date,e.lastModified=+e.lastModifiedDate,e}if(d&&(r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(e){return e&&-1<r.indexOf(Object.prototype.toString.call(e))}),u.prototype.arrayBuffer=function(){return Promise.resolve(this._buffer)},u.prototype.text=function(){return Promise.resolve(h(this._buffer))},u.prototype.slice=function(e,t,r){return new u([this._buffer.slice(e||0,t||this._buffer.length)],{type:r})},u.prototype.toString=function(){return"[object Blob]"},(n.prototype=e(u.prototype)).constructor=n,Object.setPrototypeOf)Object.setPrototypeOf(n,u);else try{n.__proto__=u}catch(e){}function o(){if(!(this instanceof o))throw new TypeError("Failed to construct 'FileReader': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");var r=document.createDocumentFragment();this.addEventListener=r.addEventListener,this.dispatchEvent=function(e){var t=this["on"+e.type];"function"==typeof t&&t(e),r.dispatchEvent(e)},this.removeEventListener=r.removeEventListener}function i(e,t,r){if(!(t instanceof u))throw new TypeError("Failed to execute '"+r+"' on 'FileReader': parameter 1 is not of type 'Blob'.");e.result="",setTimeout(function(){this.readyState=o.LOADING,e.dispatchEvent(new Event("load")),e.dispatchEvent(new Event("loadend"))})}n.prototype.toString=function(){return"[object File]"},o.EMPTY=0,o.LOADING=1,o.DONE=2,o.prototype.error=null,o.prototype.onabort=null,o.prototype.onerror=null,o.prototype.onload=null,o.prototype.onloadend=null,o.prototype.onloadstart=null,o.prototype.onprogress=null,o.prototype.readAsDataURL=function(e){i(this,e,"readAsDataURL"),this.result="data:"+e.type+";base64,"+t(e._buffer)},o.prototype.readAsText=function(e){i(this,e,"readAsText"),this.result=h(e._buffer)},o.prototype.readAsArrayBuffer=function(e){i(this,e,"readAsText"),this.result=(e._buffer.buffer||e._buffer).slice()},o.prototype.abort=function(){},URL.createObjectURL=function(e){return e instanceof u?"data:"+e.type+";base64,"+t(e._buffer):p.call(URL,e)},URL.revokeObjectURL=function(e){y&&y.call(URL,e)};var c=f.XMLHttpRequest&&f.XMLHttpRequest.prototype.send;c&&(XMLHttpRequest.prototype.send=function(e){e instanceof u?(this.setRequestHeader("Content-Type",e.type),c.call(this,h(e._buffer))):c.call(this,e)}),f.FileReader=o,f.File=n,f.Blob=u}(),o&&(File.prototype[o]="File",Blob.prototype[o]="Blob",FileReader.prototype[o]="FileReader");var w,i=f.Blob.prototype;function v(n){return new Promise(function(t,r){n.onload=n.onerror=function(e){n.onload=n.onerror=null,"load"===e.type?t(n.result||n):r(new Error("Failed to read the blob/file"))}})}try{new ReadableStream({type:"bytes"}),w=function(){var o=0,i=this;return new ReadableStream({type:"bytes",autoAllocateChunkSize:524288,pull:function(r){var n=r.byobRequest.view;return i.slice(o,o+n.byteLength).arrayBuffer().then(function(e){var t=new Uint8Array(e),e=t.byteLength;o+=e,n.set(t),r.byobRequest.respond(e),o>=i.size&&r.close()})}})}}catch(e){try{new ReadableStream({}),w=function(r){var n=0,r=this;return new ReadableStream({pull:function(t){return r.slice(n,n+524288).arrayBuffer().then(function(e){n+=e.byteLength;e=new Uint8Array(e);t.enqueue(e),n==r.size&&t.close()})}})}}catch(e){try{new Response("").body.getReader().read(),w=function(){return new Response(this).body}}catch(e){w=function(){throw new Error("Include https://github.com/MattiasBuelens/web-streams-polyfill")}}}}i.arrayBuffer||(i.arrayBuffer=function(){var e=new FileReader;return e.readAsArrayBuffer(this),v(e)}),i.text||(i.text=function(){var e=new FileReader;return e.readAsText(this),v(e)}),i.stream||(i.stream=w)}();
